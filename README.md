Trun4sfpdft
===========
Trun4sfpdft is a python script to generate natural orbitals for RAS(S)-nSF-PDFT calculation using OpenMolcas. The script prints out the occupation number of the RAS1 and RAS3 space in the natural orbital basis. It also prints the number of orbitals for a range of thresholds. Finally, an ASCII file is generated which is used in the RASSCF moldule of OpenMolcas.

The following steps may be used to perform RAS(S)-nSF-PDFT using the python script and OpenMolcas:

1. Perform an ROHF calculation for the high spin state using OpenMolcas. This can be done using the RASSCF Module with the singly occupied orbitals in RAS2 and setting RAS1/RAS3 zero.

2. Perform RAS(S)-nSF calculation using the RASSCF module in OpenMolcas. Set the singly occupied orbitals as the RAS2 space. All the doubly occupied as RAS1 space and all the virtual orbitals as the RAS3 space. Only allow one hole in RAS1 and one electron in RAS3. Use "CANONICAL" for "OUTORBITALS" in the RASSCF module.

3. Run the python script with Molcas HDF5 (.h5) file. Make sure this is generated by OpenMolcas. See usage of the python script below.

4. Repeat the RAS(S)-nSF calculation and run PDFT calculation in OpenMolcas using the ASCII file generated by the python script as the starting orbital.

## Trun4sfpdft usage:

Simply run the python script with the following options (make the python script as executable for convenience)

    script.py file1.h5 nroot

file1.h5 - Molcas HDF5 file from Step 3 above.  
nroot - Integer for the root number.

To perform the SA truncation scheme (See the SF-PDFT paper)

    script.py file1.h5 file2.h5 avg

file1.h5 - Molcas HDF5 file for one of the two states of interest.  
file2.h5 - Molcas HDF5 file for the second state of interest.  
avg - Keword for state-average.

For any questions and more into the usage and running sf-pdft, write to oimeitei(at)vt.edu

**Reference**
OR Meitei, NJ Mayhall, Spin-flip pair-density functional theory: A practical approach to treat static and dynamical correlations in large molecules
[arXiv:2102.02325](https://arxiv.org/abs/2102.02325)
